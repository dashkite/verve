@require "mixins/dimension"
@require "mixins/typography"

form

  --form-border var(--highlight)
  --form-focus var(--highlight)
  --form-autofill var(--highlight)

  display flex
  flex-direction column
  gap 2rem

  // TODO is there a better way to do this?
  //      value is set to whatever the property
  //      is at that point in the cascade...
  *
    font-size var(--copy-font-size)
    line-height var(--copy-line-height)

  & > footer
    display flex
    justify-content end
    gap 1rem
    border-top 1px solid var(--accent)
    padding-block-start 1rem
    padding-inline 1rem

  & > div
    display grid
    grid-auto-flow row dense
    grid-template-columns repeat(auto-fit, minmax(9rem, 1fr))
    gap 1em

    & > :not(.field)
      grid-column span 2

.field

  display flex
  flex-direction column
  gap 0.5rem

  &.text, &.custom
    grid-column span 2

  & > label
    display flex
    flex-direction column
    margin -0.25rem

    & > label:has(> input[type="checkbox"])
      margin-inline-start 1rem
      display flex
      gap 1rem
      align-items center
      
      & > input[type="checkbox"]
        display grid
        place-content center
        font inherit
        min-width 0
        padding 0
        appearance none
        width 0.75rem
        height 0.75rem
        border 1px solid var(--accent)
        background-color var(--background)
        border-radius 0.25rem

        &:checked
          background-color var(--highlight)
          border 1px solid var(--highlight)

    & > label:has(> input[type='radio'])
      margin-inline-start 1rem
      display flex
      gap 1rem
      align-items center

      & > input[type="radio"]
        display grid
        place-content center
        font inherit
        min-width 0
        padding 0
        appearance none
        width 0.75rem
        height 0.75rem
        border 1px solid var(--accent)
        background-color var(--background)
        border-radius 50%

        &::before
          content ""
          width 0.25rem
          height 0.25rem
          background-color var(--background)
          border-radius 50%
          transform scale(0)

        &:checked
          background-color var(--highlight)
          border 1px solid var(--highlight)

        &:checked::before
          transform scale(1)

    & > *
      margin 0.25rem

    & > span:first-child
      font-weight bold
      display block

    // & > .hint
    //   small()
    //   display list-item
    //   font-size var(--copy-font-size)
    //   margin-inline-start 1rem
    //   padding-inline-start 0.5em

    //   &::marker
    //     font-family "remixicon"
    //     content: "\F045"
    //     color var(--highlight)

    & > .hint
      & > summary
        display block
        list-style none
        &::-webkit-details-marker
          display none
        font-weight bold
        text-transform capitalize
        
        &::after
          margin-inline-start 0.5rem
          font-family "remixicon"
          content "\F045"
          font-size 1.5em
          color var(--accent)
          font-weight normal

        & + *
          margin-block-start 0.5rem
          font-style italic

    & > .error
      small()
      font-size var(--copy-font-size)
      color var(--warning)
      min-height var(--copy-line-height)

    textarea
      padding 0.75rem 0.75rem 0.5rem
      border-radius 0.5rem
      border 1px solid var(--form-border)
      color var(--foreground)
      background var(--background)
      max-width var(--copy-max-width)
      &:focus
        outline none
        // background var(--form-focus-color)
        border 1px solid var(--form-focus)
      font-family var(--monospace-font)
      height 4lh
      &.shortest
        height 1lh
      &.shorter
        height 2lh
      &.short
        height 3lh
      &.long
        height 8lh
      &.longer
        height 12lh
      &.longest
        height 16lh
        

    input
      display inline-block
      border-radius 0.5rem
      border 1px solid var(--form-border)
      &:invalid
        border 1px solid var(--warning)
      color var(--foreground)    
      background-color var(--background)
      padding 0.75rem 0.75rem 0.5rem
      &:focus
        outline none
        // background var(--form-focus-color)
        border 1px solid var(--form-focus)

      // hack to override chrome's default autofill
      // which can't otherwise be overriden (wtf)
      // https://issues.chromium.org/issues/40408794#comment77
      &:autofill
        background-color var(--form-autofill)
        box-shadow 0 0 0 1.5rem var(--form-autofill) inset

      font-family var(--monospace-font)

    & > div:has(> input[type="range"])
      display flex
      flex-direction column

      & > input[type="range"] 
        order 1
        -webkit-appearance none
        appearance none
        background transparent
        cursor pointer
        border none
        flex 1 1 auto

        &::-webkit-slider-runnable-track
          background var(--accent)
          height 0.5rem
          border-radius 0.5rem

        &::-moz-range-track
          background var(--accent)
          height 0.5rem
          border-radius 0.5rem

        &::-webkit-slider-thumb
          -webkit-appearance: none
          appearance none
          margin-top -4px
          background-color var(--foreground)
          height 1rem
          width 1rem
          border-radius 50%

        &::-moz-range-thumb
          border none
          border-radius 50%
          background-color var(--foreground)
          height 1rem
          width 1rem

      & > datalist
        order 2
        flex 1 1 auto
        display flex
        justify-content space-between

        & > option
          display none
          &:first-child, &:last-child
            display inline
          

      // &[type="radio"]
      //   border-radius 50%

      // &[type="radio"]::before
      //   content ""
      //   width 0.25rem
      //   height 0.25rem
      //   background-color var(--background)
      //   border-radius 50%
      //   transform scale(0)

      // &[type="radio"]:checked, &[type="checkbox"]:checked
      //   background-color var(--foreground)
      //   border 1px solid var(--foreground)

      // &[type="radio"]:checked::before
      //   transform scale(1)

  label:has(> input[type="file"])
    border none
    width 100%
    &:focus 
      background none
      border none
    & > input
      display none

  &[type="range"]:focus
    outline none
      


  .radio-group
    display flex
    flex-direction column
    gap 0.5rem
    p
      font-size var(--smaller-copy-font-size)
      line-height var(--smaller-copy-line-height)
      margin 0
      margin-left 1.5rem
